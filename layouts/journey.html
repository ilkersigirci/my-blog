{{ define "main" }}
  {{ partial "navigation/breadcrumb.html" . }}

  <header class="mb-8">
    <div class="mb-4 flex items-center gap-3">
      {{ partial "features/icon.html" (dict "name" "user" "size" "lg" "ariaLabel" "") }}
      <h1 class="text-foreground text-3xl font-bold">
        {{ .Title }}
      </h1>
    </div>

    {{ if .Content }}
      <div class="prose prose-neutral dark:prose-invert mb-6 max-w-none">
        {{ .Content }}
      </div>
    {{ else }}
      <p class="text-muted-foreground mb-6">
        My professional and academic journey through the years.
      </p>
    {{ end }}

    {{ $journeyData := .Site.Data.journey }}
    {{ $totalMilestones := 0 }}
    {{ range $journeyData }}
      {{ $totalMilestones = add $totalMilestones (len .milestones) }}
    {{ end }}
    
    <div class="text-muted-foreground flex items-center gap-4 text-sm">
      <div class="flex items-center gap-1">
        {{ partial "features/icon.html" (dict "name" "file-text" "size" "sm" "ariaLabel" "") }}
        <span>{{ $totalMilestones }} milestones</span>
      </div>
      <div class="flex items-center gap-1">
        {{ partial "features/icon.html" (dict "name" "calendar" "size" "sm" "ariaLabel" "") }}
        <span>Timeline view</span>
      </div>
    </div>
  </header>

  <div class="relative">
    <div class="bg-border absolute top-0 bottom-0 left-4 w-0.5"></div>

    {{ range $journeyData }}
        <div class="mb-12">
          <div class="relative mb-8 flex items-center">
            <div class="bg-primary absolute left-0 z-10 flex h-8 w-8 items-center justify-center rounded-full">
              {{ partial "features/icon.html" (dict "name" "calendar" "size" "sm" "ariaLabel" "" "class" "text-primary-foreground") }}
            </div>
            <div class="ml-12">
              <h2 class="text-foreground text-2xl font-bold">{{ .year }}</h2>
              <p class="text-muted-foreground text-sm">
                {{ len .milestones }} milestones
              </p>
            </div>
          </div>

          <div class="relative mb-8">
            <div class="ml-12 space-y-3">
              {{ range .milestones }}
                <article class="group bg-card border-border hover:bg-accent/50 rounded-lg border p-4 transition-all duration-300">
                  <div class="flex items-start gap-4">
                    <div class="flex-shrink-0 mt-1">
                      {{ if .icon }}
                        {{ if eq .icon "graduation" }}
                          {{ partial "features/icon.html" (dict "name" "lightbulb" "size" "sm" "ariaLabel" "" "class" "text-primary") }}
                        {{ else if eq .icon "work" }}
                          {{ partial "features/icon.html" (dict "name" "user" "size" "sm" "ariaLabel" "" "class" "text-blue-500") }}
                        {{ else if eq .icon "achievement" }}
                          {{ partial "features/icon.html" (dict "name" "heart" "size" "sm" "ariaLabel" "" "class" "text-yellow-500") }}
                        {{ else if eq .icon "website" }}
                          {{ partial "features/icon.html" (dict "name" "link" "size" "sm" "ariaLabel" "" "class" "text-green-500") }}
                        {{ else }}
                          {{ partial "features/icon.html" (dict "name" "check" "size" "sm" "ariaLabel" "" "class" "text-primary") }}
                        {{ end }}
                      {{ else }}
                        {{ partial "features/icon.html" (dict "name" "check" "size" "sm" "ariaLabel" "" "class" "text-primary") }}
                      {{ end }}
                    </div>

                    <div class="min-w-0 flex-1">
                      <h4 class="text-foreground group-hover:text-primary mb-2 font-medium transition-colors duration-200">
                        {{ .title }}
                      </h4>

                      {{ if .description }}
                        <p class="text-muted-foreground mb-3 text-sm">
                          {{ .description }}
                        </p>
                      {{ end }}

                      <div class="text-muted-foreground flex items-center gap-4 text-xs">
                        {{ if .date }}
                          <div class="flex items-center gap-1">
                            {{ partial "features/icon.html" (dict "name" "calendar" "size" "xs" "ariaLabel" "") }}
                            <span>{{ .date }}</span>
                          </div>
                        {{ end }}

                        {{ if .company }}
                          <div class="flex items-center gap-1">
                            {{ partial "features/icon.html" (dict "name" "user" "size" "xs" "ariaLabel" "") }}
                            <span>{{ .company }}</span>
                          </div>
                        {{ end }}

                        {{ if .location }}
                          <div class="flex items-center gap-1">
                            {{ partial "features/icon.html" (dict "name" "home" "size" "xs" "ariaLabel" "") }}
                            <span>{{ .location }}</span>
                          </div>
                        {{ end }}
                      </div>

                      {{ if .link }}
                        <div class="mt-3">
                          <a href="{{ .link }}" class="text-primary hover:text-primary/80 text-sm font-medium transition-colors duration-200">
                            {{ if .linkText }}{{ .linkText }}{{ else }}Learn more â†’{{ end }}
                          </a>
                        </div>
                      {{ end }}
                    </div>
                  </div>
                </article>
              {{ end }}
            </div>
          </div>
        </div>
      {{ end }}
    </div>

{{ end }}
